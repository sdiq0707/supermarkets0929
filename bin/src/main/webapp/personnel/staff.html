<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>员工表</title>
<script src="https://cdn.bootcss.com/vue/2.6.10/vue.js"></script>
<script src="https://cdn.bootcss.com/vue-resource/1.5.1/vue-resource.min.js"></script> 
<link href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
	<div id="app">
		<div>
		<form>
		员工id：<input type="number" v-model="staffid"/>
		<button @click="findOne(staffid)">查询</button>
		</form>
		
		
		</div>
		
		
             <div>                                                             
             <fieldset>   
                                                                  
             <legend>添加员工</legend>     
         	         姓名<input type="text" v-model="staffname	 " />                           
          	         性别<input type="text" v-model="staffsex  	 " />                            
           	         年龄<input type="text" v-model="staffage		 " />                       
           	         籍贯<input type="text" v-model="staffhome	 " />                            
         	         学历<input type="text" v-model="staffdiploma  " />                          
         	         薪资<input type="text" v-model="staffsalary	 " />                        
         	         职位<input type="text" v-model="staffduty	 " />                         
         	联系电话<input type="text" v-model="staffphone	 " />                                
         	联系地址<input type="text" v-model="staffaddress	 " />                                
                    身份证号码<input type="text" v-model="staffidcard	 " />                            
         	入职日期<input type="date" v-model="staffbegindate " />                                 
         	编制日期<input type="date" v-model="staffenacttime " />                                 
         	        备注<input type="text" v-model="staffothers    " />                        
          
             	<button @click="save">添加</button><br>                         
             
             
             </fieldset>                                                       
	         </div>                                                            
	
	
	    <!--改！！！！！！！！！！！！！！！！  -->                                             
		<div id="updateDiv" v-show="flag">
		         姓名<input type="text" v-model="u_staffname	 " /> 
	 	         性别<input type="text" v-model="u_staffsex  	 " /> 
      	         年龄<input type="text" v-model="u_staffage		 " /> 
	   	         籍贯<input type="text" v-model="u_staffhome	 " /> 
		         学历<input type="text" v-model="u_staffdiploma  " /> 
		         薪资<input type="text" v-model="u_staffsalary	 " /> 
		         职位<input type="text" v-model="u_staffduty	 " /> 
		联系电话<input type="text" v-model="u_staffphone	 " /> 
		联系地址<input type="text" v-model="u_staffaddress	 " /> 
	         身份证号码<input type="text" v-model="u_staffidcard	 " /> 
		入职日期<input type="text" v-model="u_staffbegindate " /> 
		编制日期<input type="text" v-model="u_staffenacttime " /> 
		        备注<input type="text" v-model="u_staffothers    " /> 
			<button  @click="update()">确认修改</button>
		</div>
		
		
		
		<table class="table">
			<tr>
				<th>员工编号</th>
				<th>姓名</th>
				<th>性别</th>
				<th>年龄</th>
				<th>籍贯</th>
				<th>学历</th>
				<th>薪资</th>
				<th>职位</th>
				<th>联系电话</th>
				<th>联系地址</th>
				<th>身份证号码</th>
				<th>入职日期</th>
				<th>编制日期</th>
				<th>备注</th>

			</tr>
			<tr v-for="item in list">
				<td>{{item.staffid}}</td>
				<td>{{item.staffname}}</td>
				<td>{{item.staffsex}}</td>
				<td>{{item.staffage}}</td>
				<td>{{item.staffhome}}</td>
				<td>{{item.staffdiploma}}</td>
				<td>{{item.staffsalary}}</td>
				<td>{{item.staffduty}}</td>
				<td>{{item.staffphone}}</td>
				<td>{{item.staffaddress}}</td>
				<td>{{item.staffidcard}}</td>
				<td>{{item.staffbegindate|df}}</td>
				<td>{{item.staffenacttime|df}}</td>
				<td>{{item.staffothers}}</td>
				<td><a class="btn btn-warning" @click="del(item.staffid)">删除</a> |
					<a class="btn btn-primary" @click="updateUI(item)">修改</a></td>
			</tr>
		</table>
	</div>
	<script>
		Vue.filter("df",function(dateStr){
			var dd=new Date(dateStr);
			var y=dd.getFullYear();
			var m=dd.getMonth()+1;
			var d=dd.getDate();
			return `${y}/${m}/${d}`;
		});
		
		var vue = new Vue({
			el:"#app",	
			data:{
				message:'',
				staffid:'',
				staffname:'',
				staffsex  :'',
				staffage:'',
				staffhome:'',
				staffdiploma:'',
				staffsalary:'',
				staffduty:'',
				staffphone:'',
				staffaddress:'',
				staffidcard:'',
				staffbegindate:'',
				staffenacttime:'',
				staffothers:'',
				flag:false,
				//修改和增加按钮切换
				flag2:false,
				list:'',
				u_staffid:'',
				u_staffname:'',
				u_staffsex  :'',
				u_staffage:'',
				u_staffhome:'',
				u_staffdiploma:'',
				u_staffsalary:'',
				u_staffduty:'',
				u_staffphone:'',
				u_staffaddress:'',
				u_staffidcard:'',
				u_staffbegindate:'',
				u_staffenacttime:'',
				u_staffothers:''
					
				
			},
			created() {
				this.findAll();
			},
			methods: {
		                   
		           save() {                                                                                                                                                                                                                  
		           	var json={                                                                                                                                                                                                    
		           			staffname	  :this.staffname	   ,       
		           			staffid		  :this.staffid		   ,   
		           			staffname	  :this.staffname	   ,       
		           			staffsex  	  :this.staffsex  	   ,   
		           			staffage	  :this.staffage		,          
		           			staffhome	  :this.staffhome	   ,       
		           			staffdiploma  :this.staffdiploma   ,     
		           			staffsalary	  :this.staffsalary	   ,   
		           			staffduty	  :this.staffduty	   ,       
		           			staffphone	  :this.staffphone	   ,   
		           			staffaddress  :this.staffaddress	,        
		           			staffidcard	  :this.staffidcard	   ,   
		           			staffbegindate:this.staffbegindate ,     
		           			staffenacttime:this.staffenacttime ,     
		           			staffothers   :this.staffothers    , };                                                                                                                                        
		           	this.$http.post("http://localhost:9999/staffs",json).then(function() {                                                                                                                                      
		           		this.findAll();                          
		           		    this.staffname	   =
		           		    this.staffsex  	   =
		           		    this.staffage		=
		           		    this.staffhome	   =
		           		    this.staffdiploma  =
		           		    this.staffsalary= 
		           		    this.staffduty	   =
		           	        this.staffphone	   =
		           	        this.staffaddress	=
		           	        this.staffidcard= 
		           	        this.staffbegindate=
		           	        this.staffenacttime=
		          			this.staffothers='';   
		           	
		           	});                                                                                                                                                                                                           
		           },                                                                                                                                                                                                                
			
		      /*      
		        findOne(staffid){
		        	   this.$http.get("http://localhost:9999/staffs"),{"staffid":staffid},{emulateJSON:true}).then(function(result){
		        		   this.message=result.body;
		        	   })
		           }   
		            */
		
		
		
		
				findAll() {
					this.$http.get("http://localhost:9999/staffs").then(function(result) {
						this.list = result.body;
					});
				},
				del(staffid){
					this.$http.post("http://localhost:9999/staffs",{"staffid":staffid,"_method":"delete"},{emulateJSON:true}).then(function(){
						this.findAll();
					});
				},
				updateUI(item){
					this.u_staffid		 =item.staffid,
					this.u_staffname	 =item.staffname,
					this.u_staffid		 =item.staffid		  ,
					this.u_staffname	 =item.staffname	  ,
					this.u_staffsex  	 =item.staffsex  	  ,
					this.u_staffage		 =item.staffage		  ,
					this.u_staffhome	 =item.staffhome	  ,
					this.u_staffdiploma  =item.staffdiploma   ,
					this.u_staffsalary	 =item.staffsalary	  ,
					this.u_staffduty	 =item.staffduty	  ,
					this.u_staffphone	 =item.staffphone	  ,
					this.u_staffaddress	 =item.staffaddress	  ,
					this.u_staffidcard	 =item.staffidcard	  ,
					this.u_staffbegindate=item.staffbegindate ,
					this.u_staffenacttime=item.staffenacttime ,
					this.u_staffothers   =item.staffothers    ,
					this.flag=true
				},
				update(){
				var json={  staffid		  :this.u_staffid		   ,
							staffname	  :this.u_staffname	   ,
						    staffid		  :this.u_staffid		   ,
						    staffname	  :this.u_staffname	   ,
						    staffsex  	  :this.u_staffsex  	   ,
						    staffage	  :this.u_staffage	,
						    staffhome	  :this.u_staffhome	   ,
						    staffdiploma  :this.u_staffdiploma   ,
						    staffsalary	  :this.u_staffsalary	   ,
						    staffduty	  :this.u_staffduty	   ,
						    staffphone	  :this.u_staffphone	   ,
						    staffaddress  :this.u_staffaddress,
						    staffidcard	  :this.u_staffidcard	   ,
						    staffbegindate:this.u_staffbegindate ,
						    staffenacttime:this.u_staffenacttime ,
						    staffothers   :this.u_staffothers    ,
							"_method":"put"
					};
					this.$http.post("http://localhost:9999/staffs",json,{emulateJSON:true}).then(function(){
						this.findAll();
						this.flag=false;
					});
				}
			}
		});
	</script>
</body>
</html>