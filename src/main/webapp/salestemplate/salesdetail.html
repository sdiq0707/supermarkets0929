<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" />
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/vue/2.6.10/vue.js"></script>
<script src="https://cdn.bootcss.com/vue-resource/1.5.1/vue-resource.min.js"></script>
</head>
<body>
<div id="app">
		<div v-show="flag" style="border:1px solid red">
			销售编号：<input type="text" v-model="u_sdid" class="input-medium search-query"></br>
			商品编号：<input type="text" v-model="u_productid" class="input-medium search-query"></br>
			商品名称：<input type="text" v-model="u_pname" class="input-medium search-query"></br>
			销售数量：<input type="text" v-model="u_salequantiy" class="input-medium search-query"></br>
			销售价格：<input type="text" v-model="u_psellprice" class="input-medium search-query"></br>
			商品规格编号：       <input type="text" v-model="u_psid" class="input-medium search-query"></br>
			<button @click="update">确认修改</button>
		</div>
		<div style="padding: 0px 400px 0px;border:10px solid yellow">
	        <div class="input-group">
	            <span class="input-group-addon">销售编号：</span>
	            <input type="text" class="form-control" v-model="sdid"/>
	        </div>
	        <br>
	        <div class="input-group">
	            <span class="input-group-addon">商品编号（名称）：</span>
	            <select >
	            	<option v-for="item in list" value="item.product.pname">{{item.product.pname}}</option>
	            </select>
	        </div>
	        <br>
	        <div class="input-group">
	            <span class="input-group-addon">商品名称：</span>
	            <input type="text" class="form-control" v-model="pname">
	        </div>
	        <br>
	        <div class="input-group">
	            <span class="input-group-addon" >销售数量：</span>
	            <input type="text" class="form-control" v-model="salequantiy">
	        </div>
	        <br>
	        <div class="input-group">
	            <span class="input-group-addon" >销售价格：</span>
	            <input type="text" class="form-control" v-model="psellprice">
	        </div>
	        <br>
	        <div class="input-group">
	            <span class="input-group-addon"  >商品规格编号：</span>
	            <input type="text" class="form-control"  v-model="psid" >
	        </div>
	        </br>
		</div>
		<button @click="save">save</button>
			<table class="table table-striped">
		<caption>销售细节表</caption>
		<thead>
			<tr>
				<th>销售编号</th>
				<th>商品编号</th>
				<th>商品名称</th>
				<th>销售数量</th>
				<th>销售价格</th>
				<th>商品规格编号</th>
				<th>
				修改
				|
				删除
				</th>
			</tr>
		</thead>
		<tbody>
			<tr v-for="item in list">
				<td>{{item.sdid}}</td>
				<td>{{item.productid}}</td>
				<td>{{item.pname}}</td>
				<td>{{item.salequantiy}}</td>
				<td>{{item.psellprice}}</td>
				<td>{{item.psid}}</td>
				<td>
				<a @click="updateUI(item)">修改</a>
				<a @click="del(item.sdid)">删除</a>
				</td>
			</tr>
		</tbody>
	</table>
	</div>
	
	<script type="text/javascript">
		var vue=new Vue({
			el:"#app",
			data:{
				sdid:"",
				productid:"",
				pname:"",
				salequantiy:"",
				psellprice:"",
				psid:"",
				list:"",
				flag:false,
				u_sdid:"",
				u_productid:"",
				u_pname:"",
				u_salequantiy:"",
				u_psellprice:"",
				u_psid:"",
			},
			created(){
				this.findAll();
			},
			methods:{
				save(){
					
						console.log(this.salequantiy + " --- " + this.psellprice);
						var json={	sdid:this.sdid,
									productid:this.productid,
									pname:this.pname,
									salequantiy:this.salequantiy,
									psellprice:this.psellprice,
									psid:this.psid
							};
					this.$http.post("http://localhost:9999/salesDetail",json).then(function(){
						this.findAll();
						this.sdid=this.productid=this.pname=this.salequantiy=this.psellprice=this.psid="";
					});
				},
				findAll(){
					this.$http.get("http://localhost:9999/salesDetail").then(function(result){
						this.list=result.body;
					});
				},
				del(id){
					this.$http.post("http://localhost:9999/salesDetail",{"sdid":id,"_method":"delete"},{emulateJSON:true}).then(function(){
						this.findAll();
					});
				},
				updateUI(item){
					this.u_sdid=item.sdid;
					this.u_productid=item.productid;
					this.u_pname=item.pname;
					this.u_salequantiy=item.salequantiy;
					this.u_psellprice=item.psellprice;
					this.u_psid=item.psid;
					this.flag=true;
					
				},
				update(){
					var json={sdid:this.u_sdid,
							productid:this.u_productid,
							pname:this.u_pname,
							salequantiy:this.u_salequantiy,
							psellprice:this.u_psellprice,
							psid:this.u_psid,
							"_method":"put"
					};
					this.$http.post("http://localhost:9999/salesDetail",json,{emulateJSON:true}).then(function(){
						this.findAll();
						this.flag=false;
					});
				}
			}
		});
	</script>
</body>
</html>